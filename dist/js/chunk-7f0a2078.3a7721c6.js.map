{"version":3,"sources":["webpack:///./src/components/common/login/Login.vue?3fc9","webpack:///./src/components/common/login/Login.vue?3355","webpack:///./src/network/login.js","webpack:///src/components/common/login/Login.vue","webpack:///./src/components/common/login/Login.vue?4444","webpack:///./src/components/common/login/Login.vue","webpack:///./src/network/userlist/playlist.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","staticStyle","_v","ref","ValidateForm","required","message","model","value","callback","$$v","$set","_n","expression","on","$event","submitForm","resetForm","staticRenderFns","login","tel","pwd","getTimestamp","Date","getTime","request","url","params","phone","password","timestamp","getLoginStatus","cookies","cookie","getLikelist","uid","token","name","components","data","telephone","loginStatus","listMessage","methods","then","res","code","console","log","alert","setTimeout","playlist","forEach","obj","coverImgUrl","item","id","trackCount","songlistMesArr","push","component","getListMessage","userId","getListCount","getCorMusicId"],"mappings":"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","file":"js/chunk-7f0a2078.3a7721c6.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=3fde0b66&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"login\"}},[_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"center\",\"gutter\":0}},[_c('el-col',{attrs:{\"span\":8}},[_c('div',{staticClass:\"grid-content\"})])],1),_c('el-row',{attrs:{\"gutter\":0,\"type\":\"flex\",\"justify\":\"center\"}},[_c('el-col',{attrs:{\"span\":22.5}},[_c('el-card',{staticStyle:{\"border-radius\":\"24px\",\"width\":\"82vw\"},attrs:{\"shadow\":\"always\"}},[_c('h2',{staticStyle:{\"text-align\":\"center\"}},[_vm._v(\"欢迎登陆\")]),_c('el-divider'),_c('el-form',{ref:\"telephoneValidateForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.ValidateForm,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"手机号\",\"prop\":\"telephone\",\"rules\":[{ required: true, message: '手机号不能为空' }]}},[_c('el-input',{attrs:{\"placeholder\":\"请输入手机号\",\"type\":\"number\"},model:{value:(_vm.ValidateForm.telephone),callback:function ($$v) {_vm.$set(_vm.ValidateForm, \"telephone\", _vm._n($$v))},expression:\"ValidateForm.telephone\"}})],1),_c('el-form-item',{attrs:{\"label\":\"密码\",\"prop\":\"pwd\",\"rules\":[{ required: true, message: '密码不能为空' }]}},[_c('el-input',{attrs:{\"placeholder\":\"请输入密码\",\"show-password\":\"\"},model:{value:(_vm.ValidateForm.pwd),callback:function ($$v) {_vm.$set(_vm.ValidateForm, \"pwd\", $$v)},expression:\"ValidateForm.pwd\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm()}}},[_vm._v(\"提交\")]),_c('el-button',{on:{\"click\":function($event){return _vm.resetForm('telephoneValidateForm')}}},[_vm._v(\"重置\")])],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { request } from \"./request\";\r\n//用户登录\r\nexport function login(tel, pwd) {\r\n  var getTimestamp = new Date().getTime();\r\n  return request({\r\n    url: \"/login/cellphone\",\r\n    params: {\r\n      phone: tel,\r\n      password: pwd,\r\n      timestamp: getTimestamp,\r\n      // timestamp: 15030199,\r\n    },\r\n  });\r\n}\r\n// 登录状态\r\nexport function getLoginStatus(cookies) {\r\n  return request({\r\n    url: \"/login/status\",\r\n    params: {\r\n      cookie: cookies,\r\n    },\r\n  });\r\n}\r\n//获取喜欢的音乐\r\nexport function getLikelist(uid, token, cookie) {\r\n  return request({\r\n    url: \"/likelist\",\r\n    params: {\r\n      uid,\r\n      token,\r\n      cookie,\r\n    },\r\n  });\r\n}\r\n","<template>\r\n  <div id=\"login\">\r\n    <el-row type=\"flex\" justify=\"center\" :gutter=\"0\">\r\n      <el-col :span=\"8\">\r\n        <div class=\"grid-content\"></div>\r\n      </el-col>\r\n    </el-row>\r\n    <el-row :gutter=\"0\" type=\"flex\" justify=\"center\">\r\n      <el-col :span=\"22.5\">\r\n        <el-card shadow=\"always\" style=\"border-radius:24px;width:82vw\">\r\n          <h2 style=\"text-align:center\">欢迎登陆</h2>\r\n          <el-divider></el-divider>\r\n          <el-form\r\n            :model=\"ValidateForm\"\r\n            ref=\"telephoneValidateForm\"\r\n            label-width=\"100px\"\r\n            class=\"demo-ruleForm\"\r\n          >\r\n            <el-form-item\r\n              label=\"手机号\"\r\n              prop=\"telephone\"\r\n              :rules=\"[{ required: true, message: '手机号不能为空' }]\"\r\n            >\r\n              <el-input\r\n                placeholder=\"请输入手机号\"\r\n                type=\"number\"\r\n                v-model.number=\"ValidateForm.telephone\"\r\n              ></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item\r\n              label=\"密码\"\r\n              prop=\"pwd\"\r\n              :rules=\"[{ required: true, message: '密码不能为空' }]\"\r\n            >\r\n              <el-input\r\n                placeholder=\"请输入密码\"\r\n                v-model=\"ValidateForm.pwd\"\r\n                show-password\r\n              ></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"submitForm()\">提交</el-button>\r\n              <el-button @click=\"resetForm('telephoneValidateForm')\">重置</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { login, getLoginStatus, getLikelist } from \"@/network/login.js\";\r\nimport { getListMessage } from \"@/network/userlist/playlist\";\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  components: {},\r\n  data() {\r\n    return {\r\n      ValidateForm: {\r\n        telephone: \"\",\r\n        pwd: \"\",\r\n      },\r\n      cookies: null,\r\n      value: \"我是login组件\",\r\n      loginStatus: {},\r\n      listMessage: [],\r\n      token: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    submitForm() {\r\n      //用户登录\r\n      login(this.ValidateForm.telephone, this.ValidateForm.pwd).then((res) => {\r\n        if (res.code === 200) {\r\n          this.token = res.token;\r\n          console.log(\"登录成功\");\r\n          alert(\"登录成功\");\r\n          this.cookies = encodeURIComponent(res.cookie);\r\n          this.$store.commit(\"getCookie\", this.cookies);\r\n          this.$router.push(\"/profile\");\r\n        } else {\r\n          alert(\"密码错误\");\r\n        }\r\n      });\r\n      setTimeout(() => {\r\n        //获取登录状态（包括用户 id,头像,背景图片,昵称等）\r\n        getLoginStatus(this.cookies).then((res) => {\r\n          const data = res.data;\r\n          this.loginStatus.id = data.account.id;\r\n          this.loginStatus.avatarUrl = data.profile.avatarUrl;\r\n          this.loginStatus.backgroundUrl = data.profile.backgroundUrl;\r\n          this.loginStatus.nickname = data.profile.nickname;\r\n          this.$store.commit(\"getLoginStatus\", this.loginStatus);\r\n          //一旦获得用户 id 值，就发送获取相关歌单信息请求\r\n          if (this.$store.state.loginStatus.hasOwnProperty(\"id\")) {\r\n            //获取我喜欢音乐里每一首歌曲 id\r\n            getLikelist(\r\n              this.$store.state.loginStatus.id,\r\n              this.token,\r\n              this.$store.state.cookie\r\n            ).then((res) => {\r\n              //获取我喜欢的音乐列表(id 数组)\r\n              const ids = res.ids;\r\n              this.$store.commit(\"getLikelist\", ids);\r\n            });\r\n            //获取每个歌单的图片、id、歌单名字(如: ...喜欢的音乐)、歌曲的数量\r\n            getListMessage(this.$store.state.loginStatus.id).then((res) => {\r\n              const songlistMesArr = [];\r\n              res.playlist.forEach((item) => {\r\n                const obj = {};\r\n                obj.coverImgUrl = item.coverImgUrl;\r\n                obj.id = item.id;\r\n                obj.name = item.name;\r\n                obj.trackCount = item.trackCount;\r\n                songlistMesArr.push(obj);\r\n              });\r\n              this.listMessage = songlistMesArr;\r\n              this.$store.commit(\"getListMessage\", this.listMessage);\r\n            });\r\n          }\r\n        });\r\n      }, 1000);\r\n    },\r\n    resetForm(formName) {\r\n      // this.$refs[formName].resetFields();\r\n      this.ValidateForm.telephone = \"\";\r\n      this.ValidateForm.pwd = \"\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.grid-content {\r\n  min-height: 16vh;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=3fde0b66&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=3fde0b66&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3fde0b66\",\n  null\n  \n)\n\nexport default component.exports","import { request } from \"../request\";\r\n//根据用户 id 获取歌单信息\r\nexport function getListMessage(userId) {\r\n  return request({\r\n    url: \"/user/playlist\",\r\n    params: {\r\n      uid: userId,\r\n    },\r\n  });\r\n}\r\n//获取创建歌单和收藏歌单的数量\r\nexport function getListCount(cookie) {\r\n  return request({\r\n    url: \"/user/subcount\",\r\n    params: {\r\n      cookie,\r\n    },\r\n  });\r\n}\r\n//歌单能看到歌单名字, 但看不到具体歌单内容 ,传入歌单 id, 可 以获取对应歌单内的所有的音乐(未登录状态只能获取不完整的歌单,登录后是完整的)\r\nexport function getCorMusicId(id) {\r\n  return request({\r\n    url: '/playlist/detail',\r\n    params: {\r\n     id \r\n    }\r\n  })\r\n}"],"sourceRoot":""}